# 프록시 정책 구조 설명

이 문서는 프록시 정책의 전체적인 구조와 각 구성 요소를 설명합니다.

## 1. 전체 구조

정책은 다음과 같은 최상위 구조를 가집니다:

```
libraryContent
├── configurations (설정)
├── lists (리스트)
└── ruleGroup (정책 그룹)
```

## 2. 정책 그룹 (ruleGroup)

정책 그룹은 계층적 구조를 가지며, 하나의 그룹 안에 다른 그룹이나 규칙들이 포함될 수 있습니다.

### 주요 속성
- `@id`: 그룹 식별자
- `@name`: 그룹 이름
- `@enabled`: 활성화 여부
- `condition`: 조건식
- `rules`: 하위 규칙들
- `ruleGroups`: 하위 그룹들

### 특징
- 트리 형태의 계층 구조
- 각 그룹은 자체 조건식을 가질 수 있음
- 활성화/비활성화 가능

## 3. 리스트 (lists)

정책에서 참조할 수 있는 객체 리스트입니다.

### 구조
- `list_id`: 리스트 식별자
- `list_name`: 리스트 이름
- `list_type_id`: 리스트 타입
- `list_classifier`: 분류자
- `entries`: 리스트 항목들

### 특징
- 여러 정책에서 재사용 가능
- 타입별로 분류 가능
- 각 리스트는 여러 엔트리를 포함할 수 있음

## 4. 조건식 (condition)

정책의 적용 조건을 정의하는 복잡한 표현식입니다.

### 구성 요소
- `prefix`: 조건식 접두사 (AND/OR 등)
- `property`: 속성 이름
- `operator`: 연산자
- `values`: 비교 값들
- 괄호와 중첩 조건 지원

### 특징
- 복잡한 중첩 구조 가능
- 리스트 참조 가능
- 논리 연산자를 통한 조건 조합

## 5. 설정 (configurations)

정책에서 사용하는 설정 값들을 정의합니다.

### 속성
- `configuration_id`: 설정 ID
- `name`: 설정 이름
- `version`: 버전
- `properties`: 설정 속성들

### 특징
- 정책에서 참조 가능
- 버전 관리 지원
- 여러 속성을 포함할 수 있음

## 6. 데이터베이스 구조

정책 데이터는 다음과 같은 테이블로 저장됩니다:

1. `policy_items`: 정책 그룹과 규칙 저장
   - ID, 유형, 이름, 경로 등 기본 정보
   - 활성화 상태, 액션 정보 등

2. `policy_conditions`: 조건식 저장
   - 조건식 구성 요소
   - 중첩 구조를 위한 부모-자식 관계

3. `policy_lists`: 리스트 항목 저장
   - 리스트 메타데이터
   - 리스트 엔트리

4. `policy_configurations`: 설정 저장
   - 설정 메타데이터
   - 설정 속성들

5. `condition_list_map`: 조건식과 리스트 간의 매핑
   - 조건식에서 참조하는 리스트 정보

## 7. 주요 특징

1. **계층 구조**
   - 정책은 트리 형태의 계층 구조를 가짐
   - 그룹과 규칙의 명확한 구분

2. **조건식 중첩**
   - 복잡한 조건식을 표현할 수 있음
   - 다양한 연산자와 괄호 지원

3. **리스트 참조**
   - 조건식에서 리스트를 참조할 수 있음
   - 리스트의 재사용성

4. **설정 연동**
   - 정책에서 설정 값을 참조할 수 있음
   - 설정의 중앙 관리 가능 